"use strict";(self.webpackChunkconjoon=self.webpackChunkconjoon||[]).push([[5361],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return c}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=s(n),c=i,k=u["".concat(p,".").concat(c)]||u[c]||d[c]||r;return n?a.createElement(k,l(l({ref:t},m),{},{components:n})):a.createElement(k,l({ref:t},m))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=u;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var s=2;s<r;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9621:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return p},default:function(){return c},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return d}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),l=["components"],o={id:"lumen-app-email",title:"\ud83d\udeaa lumen-app-email",slug:"/api/backends/@conjoon/lumen-app-email"},p=void 0,s={unversionedId:"backends/lumen-app-email",id:"backends/lumen-app-email",title:"\ud83d\udeaa lumen-app-email",description:"Backend service for IMAP/SMTP email messaging.",source:"@site/docs/backends/lumen-app-email.md",sourceDirName:"backends",slug:"/api/backends/@conjoon/lumen-app-email",permalink:"/docs/api/backends/@conjoon/lumen-app-email",draft:!1,editUrl:"https://github.com/conjoon/conjoon.github.io/edit/main/docs/backends/lumen-app-email.md",tags:[],version:"current",frontMatter:{id:"lumen-app-email",title:"\ud83d\udeaa lumen-app-email",slug:"/api/backends/@conjoon/lumen-app-email"},sidebar:"api",previous:{title:"Backends",permalink:"/docs/api/backends"},next:{title:"\ud83d\udeaa ddev-ms-email",permalink:"/docs/api/backends/@conjoon/ddev-ms-email"}},m={},d=[{value:"What is lumen-app-email?",id:"what-is-lumen-app-email",level:2},{value:"Installation",id:"installation",level:2},{value:"Features",id:"features",level:2},{value:"API Examples",id:"api-examples",level:2},{value:"Installation",id:"installation-1",level:2},{value:"Available CLI commands",id:"available-cli-commands",level:3},{value:"Commands",id:"commands",level:4},{value:"<code>install</code>",id:"install",level:4},{value:"<code>configure:url</code>",id:"configureurl",level:4},{value:"dotenv key",id:"dotenv-key",level:5},{value:"Example",id:"example",level:4},{value:"<code>configure:api</code>",id:"configureapi",level:3},{value:"dotenv key",id:"dotenv-key-1",level:5},{value:"Example",id:"example-1",level:4},{value:"<code>configure:env</code>",id:"configureenv",level:3},{value:"dotenv key",id:"dotenv-key-2",level:5},{value:"<code>configure:debug</code>",id:"configuredebug",level:3},{value:"dotenv key",id:"dotenv-key-3",level:5},{value:"<code>copyconfig</code>",id:"copyconfig",level:3},{value:"Configuring CORS",id:"configuring-cors",level:3},{value:"Options",id:"options",level:4},{value:"IMAP server configurations",id:"imap-server-configurations",level:3},{value:"Entry Details",id:"entry-details",level:4},{value:"Example for <code>match</code>",id:"example-for-match",level:5},{value:"Example for <code>root</code>",id:"example-for-root",level:5},{value:"Additional Resources",id:"additional-resources",level:2}],u={toc:d};function c(e){var t=e.components,n=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Backend service for IMAP/SMTP email messaging."),(0,r.kt)("h2",{id:"what-is-lumen-app-email"},"What is lumen-app-email?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"conjoon/lumen-app-email")," is a standalone ",(0,r.kt)("strong",{parentName:"p"},"PHP\ud83d\udc18")," application built with ",(0,r.kt)("a",{parentName:"p",href:"https://lumen.laravel.com"},"Lumen"),".\nIt provides a backend for Email messaging according to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/conjoon/rest-api-description"},"https://github.com/conjoon/rest-api-description"),"\nand serves endpoints for reading, writing and sending email messages with ",(0,r.kt)("strong",{parentName:"p"},"IMAP"),"/",(0,r.kt)("strong",{parentName:"p"},"SMTP"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," has minimal footprint and is easy to install."),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ composer create-project conjoon/lumen-app-email htdocs "1.*" \n')),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you're looking for a pre-configured environment for running an instance of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email"),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/api/backends/@conjoon/ddev-ms-email"},(0,r.kt)("strong",{parentName:"a"},"we might have just the\nright thing for you \ud83d\udc49")),"."))),(0,r.kt)("h2",{id:"features"},"Features"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," follows a service oriented approach.\nServices are easily replacable with the help of upfront DI configurations and related bindings."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Use lumen-app-email, if you...")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"need a fully functional middleware for communicating with IMAP / SMTP servers"),(0,r.kt)("li",{parentName:"ul"},"want to provide webmail solutions with domain-specific sign-in to IMAP accounts"),(0,r.kt)("li",{parentName:"ul"},"are looking for a distribution with minimal footprint and easy setup"),(0,r.kt)("li",{parentName:"ul"},"require a headless, service oriented standalone application with your infrastructure")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"do not use lumen-app-email, if you...")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"are looking for a stateful, session based webmail backend"),(0,r.kt)("li",{parentName:"ul"},"need baked-in caching")),(0,r.kt)("h2",{id:"api-examples"},"API Examples"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},'# Return a list of available MailAccounts for the requesting client\nGET /MailAccounts HTTP/1.1\nContent-Type: application/json\nAuthorization: Basic Y29uam9vbjpIZWxsb1dvcmxk\nHost: hostname\n\n# Return the envelope data of the first 50 MessageItems w/o previewText of the INBOX mailbox\n# for the MailAccount identified by "gmail"\nGET /MailAccounts/gmail/MailFolders/INBOX/MessageItems?start=0&limit=50&attributes=*,previewText HTTP/1.1\nContent-Type: application/json\nAuthorization: Basic Y29uam9vbjpIZWxsb1dvcmxk\nHost: hostname\n\n# Return the email identified with the uid 4356 of the INBOX mailbox for the MailAccount identified by "gmail"\nGET /MailAccounts/gmail/MailFolders/INBOX/MessageItems/4356 HTTP/1.1\nContent-Type: application/json\nAuthorization: Basic Y29uam9vbjpIZWxsb1dvcmxk\nHost: hostname\n')),(0,r.kt)("h2",{id:"installation-1"},"Installation"),(0,r.kt)("p",null,"The recommended way to install ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," is by using ",(0,r.kt)("inlineCode",{parentName:"p"},"composer create-project"),":"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"composer create-project {packageName} {targetDirectory} {version}")),(0,r.kt)("p",null,"The following command will install an instance of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," along with its dependencies into the directory\n",(0,r.kt)("inlineCode",{parentName:"p"},"htdocs")," relative to the current working directory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ composer create-project conjoon/lumen-app-email htdocs "1.*" \n')),(0,r.kt)("p",null,"Once ",(0,r.kt)("inlineCode",{parentName:"p"},"composer")," has finished downloading and installing the project, the ",(0,r.kt)("inlineCode",{parentName:"p"},"post-create-project-cmd")," will automatically invoke\n",(0,r.kt)("inlineCode",{parentName:"p"},"php artisan install"),", the installation script for ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email"),". Please refer to the subsequent documentation for\nfurther details about the configuration options available:"),(0,r.kt)("h3",{id:"available-cli-commands"},"Available CLI commands"),(0,r.kt)("p",null,"One ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," was installed with ",(0,r.kt)("inlineCode",{parentName:"p"},"composer"),", you can use ",(0,r.kt)("a",{parentName:"p",href:"https://laravel.com/docs/artisan"},"Artisan")," to interact with this\ninstance using the CLI."),(0,r.kt)("p",null,"Change the directory to your installation of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," and type"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan list\n")),(0,r.kt)("p",null,"to get a list of all commands available with this installation."),(0,r.kt)("h4",{id:"commands"},"Commands"),(0,r.kt)("p",null,"The following CLI commands are available for an instance of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Command"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#install"},"install")),(0,r.kt)("td",{parentName:"tr",align:null},"Starts the installation process")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#configureurl"},"configure:url")),(0,r.kt)("td",{parentName:"tr",align:null},"Configure URL where this instance is available")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#configureapi"},"configure:api")),(0,r.kt)("td",{parentName:"tr",align:null},"Configure API paths")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#configureenv"},"configure:env")),(0,r.kt)("td",{parentName:"tr",align:null},"Specify the environment this instance runs in")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#configuredebug"},"configure:debug")),(0,r.kt)("td",{parentName:"tr",align:null},"Enable or disable debug mode")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#copyconfig"},"copyconfig")),(0,r.kt)("td",{parentName:"tr",align:null},"Activate pre-defined configuration templates for this instance")))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Configuration settings collected by the various scripts can be found in the dotenv-file ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," in the root-directory of the installation.\nThe file can also be edited manually with the key/value pairs described in this document."))),(0,r.kt)("h4",{id:"install"},(0,r.kt)("inlineCode",{parentName:"h4"},"install")),(0,r.kt)("p",null,"Starts the installation process and queues through the ",(0,r.kt)("a",{parentName:"p",href:"#commands"},"commands")," to collect all necessary information for configuring\nthis instance. The command can also be invoked with already installed instances of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan install\n")),(0,r.kt)("h4",{id:"configureurl"},(0,r.kt)("inlineCode",{parentName:"h4"},"configure:url")),(0,r.kt)("p",null,"Specify the URL of the server where this instance is located, along with the path to the installation directory of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan configure:url\n")),(0,r.kt)("h5",{id:"dotenv-key"},"dotenv key"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_URL")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"String")),(0,r.kt)("li",{parentName:"ul"},"Default: ",(0,r.kt)("inlineCode",{parentName:"li"},"https://ddev-ms-email.ddev.site"))),(0,r.kt)("h4",{id:"example"},"Example"),(0,r.kt)("p",null,"The machine's URL serving this instance is"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://localhost:8080\n")),(0,r.kt)("p",null,"The URI of ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," on this machine is"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/lumen-app-email/htdocs\n")),(0,r.kt)("p",null,"the value of this setting must therefore be"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://localhost:8080/lumen-app-email/htdocs\n")),(0,r.kt)("h3",{id:"configureapi"},(0,r.kt)("inlineCode",{parentName:"h3"},"configure:api")),(0,r.kt)("p",null,"Specify the paths to the APIs exposed by this instance."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," provides an ",(0,r.kt)("em",{parentName:"p"},"auth"),"-Service and an ",(0,r.kt)("em",{parentName:"p"},"email"),"-Service. The ",(0,r.kt)("em",{parentName:"p"},"auth"),"-Service is required for\nauthenticating against the ",(0,r.kt)("strong",{parentName:"p"},"IMAP"),"/",(0,r.kt)("strong",{parentName:"p"},"SMTP")," servers the ",(0,r.kt)("em",{parentName:"p"},"email"),"-Service will connect to."),(0,r.kt)("p",null,"These settings provide the base-paths to the endpoints the services expose."),(0,r.kt)("p",null,"This instance will consider any path-segments representing the required API-Version\npath appended to the path automatically."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan configure:api\n")),(0,r.kt)("h5",{id:"dotenv-key-1"},"dotenv key"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_EMAIL_PATH")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"String")),(0,r.kt)("li",{parentName:"ul"},"Default: ",(0,r.kt)("inlineCode",{parentName:"li"},"rest-api-email"))),(0,r.kt)("p",null,"The path to the ",(0,r.kt)("em",{parentName:"p"},"email"),"-Service."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_AUTH_PATH")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"String")),(0,r.kt)("li",{parentName:"ul"},"Default: ",(0,r.kt)("inlineCode",{parentName:"li"},"rest-imapuser"))),(0,r.kt)("p",null,"The path to the ",(0,r.kt)("em",{parentName:"p"},"auth"),"-Service."),(0,r.kt)("h4",{id:"example-1"},"Example"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," is available at"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://localhost:8080/lumen-app-email/htdocs\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_EMAIL_PATH")," is configured with"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"api/rest-api-email\n")),(0,r.kt)("p",null,"Endpoints for this service can then be found at"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://localhost:8080/lumen-app-email/htdocs/api/rest-api-email\n")),(0,r.kt)("p",null,"Additionally, clients can require different versions for this API by appending a version tag to this\nURL as a path segment:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://localhost:8080/lumen-app-email/htdocs/api/rest-api-email/v2\n")),(0,r.kt)("p",null,"Omitting a version in the URL will default to the latest version of this API available."),(0,r.kt)("p",null,"The same applies to the ",(0,r.kt)("inlineCode",{parentName:"p"},"APP_AUTH_PATH")," setting."),(0,r.kt)("p",null,"Refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://www.conjoon.org/docs/api/rest-api"},"Backend API documentation")," for all available API endpoints."),(0,r.kt)("h3",{id:"configureenv"},(0,r.kt)("inlineCode",{parentName:"h3"},"configure:env")),(0,r.kt)("p",null,"Specify the environment this instance is used in."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan configure:env\n")),(0,r.kt)("h5",{id:"dotenv-key-2"},"dotenv key"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_ENV")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"String")),(0,r.kt)("li",{parentName:"ul"},"Default: ",(0,r.kt)("inlineCode",{parentName:"li"},"production"))),(0,r.kt)("p",null,"When using ",(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," other than on a local machine, set this to ",(0,r.kt)("inlineCode",{parentName:"p"},"production"),". For development\nor staging, this value can be set to an arbitrary value for branching into different functionality\nfor these environments, if required."),(0,r.kt)("p",null,"Note:\nThis is a setting introduced by ",(0,r.kt)("strong",{parentName:"p"},"Laravel"),". Refer to its ",(0,r.kt)("a",{parentName:"p",href:"https://laravel.com/docs/configuration#determining-the-current-environment"},"documentation")," for further information."),(0,r.kt)("h3",{id:"configuredebug"},(0,r.kt)("inlineCode",{parentName:"h3"},"configure:debug")),(0,r.kt)("p",null,"Enable/disable debug mode for this instance."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan configure:debug\n")),(0,r.kt)("h5",{id:"dotenv-key-3"},"dotenv key"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"APP_DEBUG")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Type: ",(0,r.kt)("inlineCode",{parentName:"li"},"Boolean")),(0,r.kt)("li",{parentName:"ul"},"Default: ",(0,r.kt)("inlineCode",{parentName:"li"},"false"))),(0,r.kt)("p",null,"For local development, set this to ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),". In ",(0,r.kt)("inlineCode",{parentName:"p"},"production"),", this should be set to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),", otherwise your risking to expose\nsensitive information to clients."),(0,r.kt)("p",null,"Note:\nThis is a setting introduced by ",(0,r.kt)("strong",{parentName:"p"},"Laravel"),". Refer to its ",(0,r.kt)("a",{parentName:"p",href:"https://laravel.com/docs/configuration#debug-mode"},"documentation")," for further information."),(0,r.kt)("h3",{id:"copyconfig"},(0,r.kt)("inlineCode",{parentName:"h3"},"copyconfig")),(0,r.kt)("p",null,"Copies default configuration and saves them under a name this instance requires."),(0,r.kt)("p",null,"This command processes configuration files located in ",(0,r.kt)("inlineCode",{parentName:"p"},"app/config"),"."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"copyconfig")," will probe existing configuration files and require user interaction before it accidentally\noverwrites them."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ php artisan copyconfig\n")),(0,r.kt)("p",null,"The following configuration files are affected by this command:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Template"),(0,r.kt)("th",{parentName:"tr",align:null},"Target"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"cors.example.php")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"cors.php")),(0,r.kt)("td",{parentName:"tr",align:null},"Cross-Origin Resource Sharing configuration")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"imapserver.example.php")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"imapserver.php")),(0,r.kt)("td",{parentName:"tr",align:null},"Configuration for Email servers this instance may connect to")))),(0,r.kt)("p",null,"Once the files where copied, you should adjust the settings found therein to your needs."),(0,r.kt)("h3",{id:"configuring-cors"},"Configuring CORS"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lumen-app-email")," uses ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/fruitcake/laravel-cors"},"fruitcake/laravel-cors")," for enabling\n",(0,r.kt)("a",{parentName:"p",href:"http://enable-cors.org/"},"Cross-Origin Resource Sharing"),"."),(0,r.kt)("br",null),"A configuration template can be found in `app/config/cors.php.example`.",(0,r.kt)("br",null),"Copy this file to `app/config/cors.php`, and adjust the settings to your needs. The example configuration works well with development environments, but you might want to add more strict options for production, auch as the settings for `allowed_origins` and `paths`.",(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"#copyconfig"},(0,r.kt)("inlineCode",{parentName:"a"},"php artisan copyconfig"))," can be used for automatically copying the configuration template\n",(0,r.kt)("inlineCode",{parentName:"p"},"cors.example.php")," to its target destination. If you choose to manually work with the template, copy and rename it\nto ",(0,r.kt)("inlineCode",{parentName:"p"},"cors.php"),", then adjust its entries."))),(0,r.kt)("h4",{id:"options"},"Options"),(0,r.kt)("p",null,"The options available for the cors configuration are as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"paths"),(0,r.kt)("td",{parentName:"tr",align:null},"You can enable CORS for 1 or multiple paths, eg. ",(0,r.kt)("inlineCode",{parentName:"td"},"['api/*'] ")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"[]"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"allowed_origins"),(0,r.kt)("td",{parentName:"tr",align:null},"Matches the request origin. Wildcards can be used, eg. ",(0,r.kt)("inlineCode",{parentName:"td"},"*.mydomain.com")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"mydomain.com:*")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"['*']"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"allowed_origins_patterns"),(0,r.kt)("td",{parentName:"tr",align:null},"Matches the request origin with ",(0,r.kt)("inlineCode",{parentName:"td"},"preg_match"),"."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"[]"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"allowed_methods"),(0,r.kt)("td",{parentName:"tr",align:null},"Matches the request method."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"['*']"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"allowed_headers"),(0,r.kt)("td",{parentName:"tr",align:null},"Sets the Access-Control-Allow-Headers response header."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"['*']"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"exposed_headers"),(0,r.kt)("td",{parentName:"tr",align:null},"Sets the Access-Control-Expose-Headers response header."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"max_age"),(0,r.kt)("td",{parentName:"tr",align:null},"Sets the Access-Control-Max-Age response header."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"0"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"supports_credentials"),(0,r.kt)("td",{parentName:"tr",align:null},"Sets the Access-Control-Allow-Credentials header."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))))),(0,r.kt)("h3",{id:"imap-server-configurations"},"IMAP server configurations"),(0,r.kt)("p",null,"In order for users to authenticate against IMAP servers, ",(0,r.kt)("inlineCode",{parentName:"p"},"lumen-app-email")," provides a template-configuration file in ",(0,r.kt)("inlineCode",{parentName:"p"},"app/config/imapserver.php.example"),".\nIn this file, you can specify an array of mail server configurations. Each entry represents a mail server to which connection may be established, for both sending and receiving messages."),(0,r.kt)("p",null,"Note:\n",(0,r.kt)("a",{parentName:"p",href:"#copyconfig"},(0,r.kt)("inlineCode",{parentName:"a"},"php artisan copyconfig"))," can be used for automatically copying the configuration template\n",(0,r.kt)("inlineCode",{parentName:"p"},"imapserver.example.php")," to its target destination. If you choose to manually work with the template, copy and rename it\nto ",(0,r.kt)("inlineCode",{parentName:"p"},"imapserver.php"),", then adjust its entries."),(0,r.kt)("h4",{id:"entry-details"},"Entry Details"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},'    [\n        "id"              => "Google_Mail",\n        "inbox_type"      => "IMAP",\n        "inbox_address"   => \'imap.gmail.com\',\n        "inbox_port"      => 993,\n        "inbox_ssl"       => true,\n        "outbox_address"  => "smtp.gmail.com",\n        "outbox_port"     => 465,\n        "outbox_secure"   => "ssl",\n        "root"            => ["INBOX"],\n        "match"           => ["/\\@(googlemail.)(com)$/mi"]\n    ]\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"id"),":",(0,r.kt)("em",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"required for identifying the mail account. ",(0,r.kt)("strong",{parentName:"td"},"MUST")," be unique in the configuration file. Will be refered to as ",(0,r.kt)("inlineCode",{parentName:"td"},"mailAccountId")," throughout ",(0,r.kt)("a",{parentName:"td",href:"https://conjoon.stoplight.io/docs/rest-api-description"},"rest-api-email"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"IMAP Settings"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"inbox_type"),":",(0,r.kt)("em",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"the protocol used with the server for receiving messages. Right now, only ",(0,r.kt)("strong",{parentName:"td"},"IMAP")," is supported.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"inbox_address"),":",(0,r.kt)("em",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"(ip-)address of the server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"inbox_port"),":",(0,r.kt)("em",{parentName:"td"},"integer")),(0,r.kt)("td",{parentName:"tr",align:null},"port that should be used with ",(0,r.kt)("inlineCode",{parentName:"td"},"inbox_address")," for server communication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"inbox_ssl"),":",(0,r.kt)("em",{parentName:"td"},"boolean")),(0,r.kt)("td",{parentName:"tr",align:null},"use encrypted communication with the server. ",(0,r.kt)("inlineCode",{parentName:"td"},"true"),": use ",(0,r.kt)("strong",{parentName:"td"},"SSL")," for encryption, ",(0,r.kt)("inlineCode",{parentName:"td"},"false"),": use no encryption")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"SMTP Settings"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"outbox_address"),":",(0,r.kt)("em",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"(ip-)address of the server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"outbox_port"),":",(0,r.kt)("em",{parentName:"td"},"integer")),(0,r.kt)("td",{parentName:"tr",align:null},"port that should be used with ",(0,r.kt)("inlineCode",{parentName:"td"},"outbox_address")," for server communication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"outbox_secure"),":",(0,r.kt)("em",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"the encryption protocol to use with SMTP. Can be any of ",(0,r.kt)("inlineCode",{parentName:"td"},"ssl"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"tls")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"starttls"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Account Settings"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"match"),":",(0,r.kt)("em",{parentName:"td"},"array")),(0,r.kt)("td",{parentName:"tr",align:null},"a regular expression that matches an email-address to ",(0,r.kt)("strong",{parentName:"td"},"THIS")," server configuration.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"root"),":",(0,r.kt)("em",{parentName:"td"},"array")),(0,r.kt)("td",{parentName:"tr",align:null},"an array of mailbox names that serve as root folders to display for this account. Leave the array empty if all mailboxes should be read out and send to the client.")))),(0,r.kt)("h5",{id:"example-for-match"},"Example for ",(0,r.kt)("inlineCode",{parentName:"h5"},"match")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Prerequisite:"),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"match")," is set to ",(0,r.kt)("inlineCode",{parentName:"p"},'["/\\@(googlemail.)(com)$/mi"]'),'\nA client authenticates with the username "name@',(0,r.kt)("strong",{parentName:"p"},"googlemail.com"),'". ',(0,r.kt)("inlineCode",{parentName:"p"},"lumen-app-email")," will query through the configurations of ",(0,r.kt)("inlineCode",{parentName:"p"},"imapserver.php")," and test ",(0,r.kt)("strong",{parentName:"p"},"this")," username against regular expression defined in ",(0,r.kt)("inlineCode",{parentName:"p"},"match"),". In this example, the above regular expression matches the username (i.e. email address). The configuration where the regular expression is specified will be used for subsequent operations requested by the client."),(0,r.kt)("h5",{id:"example-for-root"},"Example for ",(0,r.kt)("inlineCode",{parentName:"h5"},"root")),(0,r.kt)("p",null,"A common mailbox layout of IMAP servers looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"INBOX\nINBOX.Drafts\nINBOX.Sent\nINBOX.Junk\nINBOX.Trash\n")),(0,r.kt)("p",null,"If the ",(0,r.kt)("inlineCode",{parentName:"p"},"root"),"-configuration is set to ",(0,r.kt)("inlineCode",{parentName:"p"},'["INBOX"]'),", the following mailboxes will be returned to the client:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"INBOX\nDrafts\nSent\nJunk\nTrash\n")),(0,r.kt)("p",null,'Multiple root entries will be considered. This is useful with Google Mail, where root mailboxes (in gmail terms: "labels") can either be ',(0,r.kt)("inlineCode",{parentName:"p"},"[Google Mail]")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"[Gmail]"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"root")," should be set to ",(0,r.kt)("inlineCode",{parentName:"p"},'["[Google Mail]", "[Gmail]"]')," in this case."),(0,r.kt)("h2",{id:"additional-resources"},"Additional Resources"),(0,r.kt)("p",null,"The documentation of ",(0,r.kt)("a",{parentName:"p",href:"https://conjoon.stoplight.io/docs/rest-api-description"},"rest-api-email")," provides information about querying available mailboxes for an authenticated client."))}c.isMDXComponent=!0}}]);